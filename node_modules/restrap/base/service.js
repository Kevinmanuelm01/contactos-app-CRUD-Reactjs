var restrap = require('restrap');
var app     = restrap();

// Point to your local restrap configuration file.
app._env = 'dev';
app.config('config');

// Import custom libraries from ./lib
app.library(['user', 'util', 'orm']);

// Define a validation method required for certain requests.
app.validate('user', function(self){
  // self.params
  // self.library('user')
  // self.error()
  // self.success()
  return self.success();
});

// Define a set of routes (@type, @uri, @module)
// Chain array of validations to the route.
app.route('get', '/user', '/user/read').validate(['user']);

// Start up the app.
app.listen();

// Flag triggered calls.
// node service --use=test
app.call('test', '/user/read').then(function(r){
  console.log(r);
});
